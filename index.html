<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>پاکت پستی جادویی</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-image: url('https://s6.uupload.ir/files/a1847282d3a235483295bed4e7d5d03f_x0h2.jpg');
            background-size: cover;
            background-position: center;
            overflow: hidden;
            font-family: Arial, sans-serif;
            perspective: 1000px;
        }

        #envelope-container {
            position: relative;
            width: 300px;
            height: 200px;
            display: none;
            transform-style: preserve-3d;
            cursor: pointer;
        }

        #envelope {
            width: 100%;
            height: 100%;
            background-image: url('https://s6.uupload.ir/files/labubu_o59.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.5s ease;
        }

        #envelope.flap-open {
            transform: rotateX(180deg);
        }

        #card {
            position: fixed;
            width: 60%;
            height: 40%;
            background-image: url('https://s6.uupload.ir/files/labubu2_8hde.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            transform-origin: center;
            transition: transform 1s ease-out;
            z-index: -1;
        }

        #card.pop-out {
            transform: translate(-50%, -50%) scale(0.8);
            z-index: 1;
        }

        #card.zoom-in {
            transform: translate(-50%, -50%) scale(1.5);
            transition: transform 2s ease-in;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f00;
            opacity: 0;
            z-index: 10;
        }

        .firework {
            position: absolute;
            width: 5px;
            height: 5px;
            border-radius: 50%;
            box-shadow: 0 0 10px 5px;
            opacity: 0;
            z-index: 10;
        }

        .light-effect {
            position: absolute;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, rgba(255,255,255,0) 70%);
            opacity: 0;
            z-index: 5;
        }

        #loading {
            color: white;
            font-size: 24px;
            text-shadow: 0 0 5px black;
        }
    </style>
</head>
<body>
    <div id="loading">در حال آماده‌سازی...</div>
    <div id="envelope-container">
        <div id="envelope"></div>
    </div>
    <div id="card"></div>

   <audio id="bg-music">
        <source src="https://uploadkon.ir/uploads/078c15_25Collection-Song-Happy-Birthday-insta-trend-320-.mp3" type="audio/mpeg">
    </audio>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const loading = document.getElementById('loading');
            const envelopeContainer = document.getElementById('envelope-container');
            const envelope = document.getElementById('envelope');
            const card = document.getElementById('card');
            const bgMusic = document.getElementById('bg-music');

            // مرحله 1: نمایش پاکت پس از 3 ثانیه
            setTimeout(() => {
                loading.style.display = 'none';
                envelopeContainer.style.display = 'block';
               
                // انیمیشن fade in برای پاکت
                envelopeContainer.style.animation = 'fadeIn 1s forwards';
                const style = document.createElement('style');
                style.innerHTML = `
                    @keyframes fadeIn {
                        from { opacity: 0; transform: translateY(50px) rotateX(90deg); }
                        to { opacity: 1; transform: translateY(0) rotateX(0); }
                    }
                `;
                document.head.appendChild(style);
            }, 3000);

            // مرحله 2: کلیک روی پاکت
            envelopeContainer.addEventListener('click', function() {
                // باز کردن درب پاکت
                envelope.classList.add('flap-open');
               
                // پخش خودکار موسیقی بلافاصله پس از کلیک روی پاکت
                bgMusic.play()
                    .then(() => console.log('موسیقی با موفقیت پخش شد'))
                    .catch(e => console.error('خطا در پخش خودکار:', e));
               
                // نمایش کارت
                setTimeout(() => {
                    card.classList.add('pop-out');
                   
                    // زوم کردن کارت
                    setTimeout(() => {
                        card.classList.add('zoom-in');
                       
                        // نمایش افکت‌های جشن
                        createCelebrationEffects();
                       
                        // توقف افکت‌ها پس از 10 ثانیه
                        setTimeout(() => {
                            stopCelebrationEffects();
                        }, 10000);
                    }, 1000);
                }, 500);
            });

            // ایجاد افکت‌های جشن
            function createCelebrationEffects() {
                const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff'];
                const effectsInterval = setInterval(() => {
                    // ایجاد کاغذ رنگی (confetti)
                    for (let i = 0; i < 20; i++) {
                        const confetti = document.createElement('div');
                        confetti.className = 'confetti';
                        confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                        confetti.style.left = Math.random() * 100 + 'vw';
                        confetti.style.top = -10 + 'px';
                        confetti.style.transform = 'rotate(' + Math.random() * 360 + 'deg)';
                        document.body.appendChild(confetti);
                       
                        // انیمیشن کاغذ رنگی
                        const animation = confetti.animate([
                            { top: '-10px', opacity: 0, transform: 'rotate(0deg) scale(0)' },
                            { top: '-10px', opacity: 1, transform: 'rotate(0deg) scale(1)', offset: 0.1 },
                            { top: '110vh', opacity: 1, transform: 'rotate(' + (Math.random() * 360) + 'deg) scale(0.5)' }
                        ], {
                            duration: 3000 + Math.random() * 2000,
                            easing: 'cubic-bezier(0.1, 0.8, 0.9, 1)'
                        });
                       
                        animation.onfinish = () => confetti.remove();
                    }
                   
                    // ایجاد افکت نورانی
                    const light = document.createElement('div');
                    light.className = 'light-effect';
                    light.style.left = Math.random() * 80 + 'vw';
                    light.style.top = Math.random() * 80 + 'vh';
                    document.body.appendChild(light);
                   
                    // انیمیشن نور
                    light.animate([
                        { opacity: 0, transform: 'scale(0)' },
                        { opacity: 0.7, transform: 'scale(1)', offset: 0.3 },
                        { opacity: 0, transform: 'scale(2)' }
                    ], {
                        duration: 2000 + Math.random() * 1000,
                        easing: 'ease-out'
                    });
                   
                    setTimeout(() => light.remove(), 3000);
                   
                    // ایجاد فشفه
                    if (Math.random() > 0.7) {
                        createFirework();
                    }
                }, 200);
               
                // ذخیره اینتروال برای توقف بعدی
                window.celebrationInterval = effectsInterval;
            }
           
            function createFirework() {
                const x = Math.random() * 80 + 10;
                const y = Math.random() * 80 + 10;
                const color = `hsl(${Math.random() * 360}, 100%, 50%)`;
               
                // مرکز فشفه
                const center = document.createElement('div');
                center.className = 'firework';
                center.style.left = x + 'vw';
                center.style.top = y + 'vh';
                center.style.backgroundColor = color;
                document.body.appendChild(center);
               
                // انیمیشن مرکز
                center.animate([
                    { opacity: 1, transform: 'scale(1)', boxShadow: `0 0 5px 2px ${color}` },
                    { opacity: 0, transform: 'scale(5)', boxShadow: `0 0 20px 10px ${color}` }
                ], {
                    duration: 1000,
                    easing: 'ease-out'
                });
               
                // ذرات فشفه
                for (let i = 0; i < 30; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'firework';
                    particle.style.left = x + 'vw';
                    particle.style.top = y + 'vh';
                    particle.style.backgroundColor = color;
                    document.body.appendChild(particle);
                   
                    const angle = Math.random() * Math.PI * 2;
                    const distance = 5 + Math.random() * 10;
                    const duration = 800 + Math.random() * 500;
                   
                    particle.animate([
                        {
                            opacity: 1,
                            transform: 'translate(0, 0) scale(1)',
                            boxShadow: `0 0 5px 2px ${color}`
                        },
                        {
                            opacity: 0,
                            transform: `translate(${Math.cos(angle) * distance}vw, ${Math.sin(angle) * distance}vh) scale(0.2)`,
                            boxShadow: `0 0 10px 5px ${color}`
                        }
                    ], {
                        duration: duration,
                        easing: 'ease-out'
                    });
                   
                    setTimeout(() => particle.remove(), duration);
                }
               
                setTimeout(() => center.remove(), 1000);
            }
           
            function stopCelebrationEffects() {
                clearInterval(window.celebrationInterval);
                const effects = document.querySelectorAll('.confetti, .firework, .light-effect');
                effects.forEach(effect => {
                    effect.animate([
                        { opacity: 1 },
                        { opacity: 0 }
                    ], {
                        duration: 500,
                        easing: 'ease-out'
                    });
                    setTimeout(() => effect.remove(), 500);
                });
            }
        });
    </script>
</body>
</html>
